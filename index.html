<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Zoe Atlas üêû</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    #map {
      flex: 1;
      height: 100%;
    }

    /* Sidebar */
    #sidebar {
      width: 320px;
      max-width: 80%;
      background: #e6ffe6;
      border-right: 3px solid #ff66b2;
      overflow-y: auto;
      padding: 10px;
      position: fixed;
      top: 0;
      bottom: 0;
      left: 0;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      transition: transform 0.3s ease;
    }
    #sidebar.hidden {
      transform: translateX(-100%);
    }
    #sidebar.show {
      transform: translateX(0);
    }

    #sidebar h1 {
      margin: 0;
      font-size: 1.8em;
      text-align: center;
      color: #ff3399;
    }
    #sidebar p {
      font-size: 0.95em;
      margin: 5px 0 10px;
      text-align: center;
    }
    .controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }
    #search-bar {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
    }
    #reset-view {
      width: 100%;
      padding: 8px;
      border: none;
      background-color: #ff66b2;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    #place-list {
      flex-grow: 1;
      overflow-y: auto;
    }
    details {
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: white;
      padding: 5px;
    }
    summary {
      font-weight: bold;
      cursor: pointer;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 10px 0 0 10px;
    }
    li {
      margin-bottom: 8px;
      cursor: pointer;
      padding: 6px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #fafafa;
      transition: background 0.3s;
    }
    li:hover {
      background: #f0f0f0;
    }

    /* Toggle button */
    #toggleBtn {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 1100;
      background-color: #ff66b2;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      display: none; /* hidden on desktop by default */
    }

    footer {
      background-color: #ff66b2;
      color: white;
      text-align: center;
      padding: 8px;
      position: fixed;
      bottom: 0;
      width: 100%;
      font-size: 0.9em;
    }

    /* Mobile adjustments */
    @media (max-width: 768px) {
      #toggleBtn {
        display: block;
      }
      #sidebar {
        width: 75%; /* smaller width on mobile */
        max-width: none;
      }
    }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB38rOcYSnjrdPynqMR6i0vpP8ZYi1Z2W4"></script>
  <script>
    let map;
    let markers = [];
    const places = [
      // (your place list here ‚Äî unchanged)
    ];

    function addMarkersToMap(filteredPlaces) {
      markers.forEach(marker => marker.setMap(null));
      markers = [];

      filteredPlaces.forEach(place => {
        const marker = new google.maps.Marker({
          position: place.position,
          map: map,
          title: place.name,
          animation: google.maps.Animation.DROP
        });
        const infoContent = `<h3>${place.name}</h3><p>${place.description}</p><p><em>${place.address}</em></p>` +
          (place.link ? `<p><a href="${place.link}" target="_blank">Website</a></p>` : '');
        const infoWindow = new google.maps.InfoWindow({ content: infoContent });
        marker.addListener("click", () => infoWindow.open(map, marker));
        markers.push(marker);
      });
    }

    function renderPlaces(filteredPlaces) {
      const list = document.getElementById("place-list");
      list.innerHTML = '';
      const grouped = {};
      filteredPlaces.forEach(place => {
        if (!grouped[place.country]) grouped[place.country] = {};
        if (!grouped[place.country][place.city]) grouped[place.country][place.city] = [];
        grouped[place.country][place.city].push(place);
      });

      Object.keys(grouped).forEach(country => {
        const countryDetails = document.createElement("details");
        countryDetails.open = true;
        const countrySummary = document.createElement("summary");
        countrySummary.textContent = country;
        countryDetails.appendChild(countrySummary);

        Object.keys(grouped[country]).forEach(city => {
          const cityDetails = document.createElement("details");
          cityDetails.open = true;
          const citySummary = document.createElement("summary");
          citySummary.textContent = city;
          cityDetails.appendChild(citySummary);
          const ul = document.createElement("ul");
          grouped[country][city].forEach(place => {
            const li = document.createElement("li");
            li.innerHTML = `<strong>${place.name}</strong><br><small>${place.description}</small>`;
            li.addEventListener("click", () => {
              map.setCenter(place.position);
              map.setZoom(15);
              const marker = markers.find(m => m.title === place.name);
              if (marker) {
                const infoContent = `<h3>${place.name}</h3><p>${place.description}</p><p><em>${place.address}</em></p>` +
                  (place.link ? `<p><a href="${place.link}" target="_blank">Website</a></p>` : '');
                const infoWindow = new google.maps.InfoWindow({ content: infoContent });
                infoWindow.open(map, marker);
              }
              // auto-close sidebar on mobile
              if (window.innerWidth <= 768) {
                document.getElementById("sidebar").classList.add("hidden");
                document.getElementById("sidebar").classList.remove("show");
              }
            });
            ul.appendChild(li);
          });
          cityDetails.appendChild(ul);
          countryDetails.appendChild(cityDetails);
        });
        list.appendChild(countryDetails);
      });
    }

    function filterPlaces() {
      const searchTerm = document.getElementById("search-bar").value.toLowerCase();
      const filtered = places.filter(place =>
        place.name.toLowerCase().includes(searchTerm) ||
        place.description.toLowerCase().includes(searchTerm) ||
        place.address.toLowerCase().includes(searchTerm)
      );
      renderPlaces(filtered);
      addMarkersToMap(filtered);
    }

    function resetView() {
      document.getElementById("search-bar").value = "";
      map.setZoom(3);
      map.setCenter({ lat: 20, lng: -20 });
      filterPlaces();
    }

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 3,
        center: { lat: 20, lng: -20 }
      });
      addMarkersToMap(places);
      renderPlaces(places);
      document.getElementById("search-bar").addEventListener("keyup", filterPlaces);
      document.getElementById("reset-view").addEventListener("click", resetView);
    }

    document.addEventListener("DOMContentLoaded", () => {
      const sidebar = document.getElementById("sidebar");
      const toggleBtn = document.getElementById("toggleBtn");

      // default closed on mobile
      if (window.innerWidth <= 768) {
        sidebar.classList.add("hidden");
      }

      toggleBtn.addEventListener("click", () => {
        sidebar.classList.toggle("show");
        sidebar.classList.toggle("hidden");
      });

      window.addEventListener("resize", () => {
        if (window.innerWidth > 768) {
          sidebar.classList.remove("hidden");
          sidebar.classList.remove("show");
        } else {
          sidebar.classList.add("hidden");
          sidebar.classList.remove("show");
        }
      });
    });
  </script>
</head>
<body onload="initMap()">
  <button id="toggleBtn">‚ò∞</button>
  <div id="sidebar">
    <h1>Zoe's Atlas üêû</h1>
    <p>Curated, Black-friendly, and welcoming spots across the globe.<br>Click a place to zoom in & see details.</p>
    <div class="controls">
      <input type="text" id="search-bar" placeholder="Search places..." aria-label="Search places">
      <button id="reset-view">View All Locations</button>
    </div>
    <div id="place-list"></div>
  </div>
  <div id="map"></div>
  <footer>
    <p>Curated with ‚ù§Ô∏è by Zoe</p>
  </footer>
</body>
</html>
